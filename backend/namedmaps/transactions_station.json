{
  "version": "0.0.1",
  "name": "transactions_station",
  "auth": {
    "method": "open"
  },
  "placeholders": {
    "date_start": {
      "type": "sql_ident",
      "default": "'2015-01-01'"
    },
    "date_finish": {
      "type": "sql_ident",
      "default": "'2015-07-01'"
    },
    "family":{
      "type" : "sql_ident",
      "default" : "%"
    },
    "payment_type":{
      "type" : "sql_ident",
      "default" : "%"
    }
  },
  "layergroup": {
    "version": "1.0.1",
    "layers": [
      {
        "type": "cartodb",
        "options": {
          "cartocss_version": "2.1.1",
          "cartocss": "#transactions{ marker-fill: #FFCC00; marker-width: 12; marker-line-color: #FFF;marker-line-width: 0.5;marker-line-opacity: 0.3;marker-fill-opacity: 0.8;marker-comp-op: multiply;marker-type: ellipse;marker-placement: point;marker-allow-overlap: true;marker-clip: false;marker-multi-policy: largest;}",
          "sql": "SELECT SUM(importe_abonado) as amount,station_id as cartodb_id,the_geom,the_geom_webmercator FROM transactions WHERE familia_pago LIKE '<%= family %>' AND payment_type LIKE '<%= payment_type %>' AND date_transaction>=<%= date_start%> AND date_transaction<=<%= date_finish%>  GROUP BY station_id,the_geom,the_geom_webmercator",
          "interactivity": ["cartodb_id", "amount"]
        }
      }
    ]
  }
}
